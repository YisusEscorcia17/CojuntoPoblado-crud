<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="description" content="Sistema de gesti√≥n de propietarios y veh√≠culos para conjuntos residenciales" />
  <title>Gesti√≥n de Propietarios | Conjunto el Poblado</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header class="wrap header">
    <div>
      <h1>üè¢ Gesti√≥n de Propietarios</h1>
      <p class="muted">Sistema de control de propietarios, veh√≠culos y estado de mora</p>
    </div>
    <div class="header-info"></div>
  </header>

  <main class="wrap grid">
    <!-- FORMULARIO -->
    <section class="card form-section" data-admin-only>
      <h2 id="formTitle">‚úèÔ∏è Agregar propietario</h2>

      <form id="form">
        <input type="hidden" id="id" />

        <!-- Informaci√≥n b√°sica -->
        <div class="form-group">
          <h3 class="group-title">Informaci√≥n b√°sica</h3>
          
          <div class="row">
            <label for="nombrePropietario">Nombre del propietario</label>
            <input id="nombrePropietario" type="text" placeholder="Ej: Juan P√©rez" required />
          </div>

          <div class="row">
            <label for="correo">Correo electr√≥nico</label>
            <input id="correo" type="email" placeholder="correo@dominio.com" required />
          </div>

          <div class="row">
            <label for="cedula">C√©dula</label>
            <input id="cedula" type="text" placeholder="Ej: 1082123456" required />
          </div>
        </div>

        <!-- Ubicaci√≥n -->
        <div class="form-group">
          <h3 class="group-title">Ubicaci√≥n</h3>
          
          <div class="two">
            <div class="row">
              <label for="torre">Torre</label>
              <input id="torre" type="text" placeholder="Ej: A" required />
            </div>
            <div class="row">
              <label for="apartamento">Apartamento</label>
              <input id="apartamento" type="text" placeholder="Ej: 503" required />
            </div>
          </div>
        </div>

        <!-- Veh√≠culos -->
        <div class="form-group">
          <h3 class="group-title">Veh√≠culos</h3>
          
          <div class="two">
            <div class="row">
              <label for="cantidadCarros">Cantidad de carros</label>
              <input id="cantidadCarros" type="number" min="0" value="0" />
            </div>
            <div class="row">
              <label for="cantidadMotos">Cantidad de motos</label>
              <input id="cantidadMotos" type="number" min="0" value="0" />
            </div>
          </div>

          <div class="two">
            <div class="row">
              <label for="placaCarro">Placa del carro</label>
              <input id="placaCarro" type="text" placeholder="ABC123" />
            </div>
            <div class="row">
              <label for="placaMoto">Placa de la moto</label>
              <input id="placaMoto" type="text" placeholder="XYZ45D" />
            </div>
          </div>
        </div>

        <!-- Estado de mora -->
        <div class="form-group">
          <h3 class="group-title">Estado de mora</h3>
          
          <div class="row inline-group">
            <input id="moroso" type="checkbox" />
            <label for="moroso">¬øEst√° en mora?</label>
          </div>

          <div class="row">
            <label for="deudaMoroso">Deuda total (COP)</label>
            <input id="deudaMoroso" type="number" min="0" step="1" value="0" disabled />
          </div>
        </div>

        <div class="actions" data-admin-only>
          <button class="btn" type="submit" id="btnGuardar">üíæ Guardar</button>
          <button class="btn ghost" type="button" id="btnCancelar" hidden>‚úñÔ∏è Cancelar</button>
        </div>

        <p id="msg" class="msg"></p>
      </form>
    </section>

    <!-- LISTADO Y B√öSQUEDA -->
    <section class="card list-section">
      <h2>üìã Listado de propietarios</h2>
      
      <div class="toolbar">
        <p class="muted">Busca, filtra y gestiona tus registros</p>

        <div class="filters">
          <div class="search-group">
            <input id="q" type="text" placeholder="üîç Buscar por nombre, c√©dula, placa..." />
            <select id="fMoroso">
              <option value="">Todos</option>
              <option value="1">‚ö†Ô∏è Solo morosos</option>
              <option value="0">‚úÖ Solo al d√≠a</option>
            </select>
            <button class="btn" id="btnBuscar" type="button">Buscar</button>
          </div>

          <div class="export-group" data-admin-only>
            <a class="btn ghost" href="/api/export/propietarios.csv" title="Descargar listado en CSV">üì• Propietarios</a>
            <a class="btn ghost" href="/api/export/historial.csv" title="Descargar historial en CSV">üì• Historial</a>
            <button class="btn ghost" id="btnBackup" type="button" title="Crear respaldo de la base de datos">üíæ Backup</button>
          </div>
        </div>
      </div>

      <div class="tableWrap">
        <table>
          <thead>
            <tr>
              <th>Nombre</th>
              <th>Correo</th>
              <th>C√©dula</th>
              <th>Torre</th>
              <th>Apto</th>
              <th>Carros</th>
              <th>Motos</th>
              <th>Placa carro</th>
              <th>Placa moto</th>
              <th>Moroso</th>
              <th>Deuda</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody id="tbody"></tbody>
        </table>
      </div>
    </section>
  </main>

  <footer class="footer">
    <div class="wrap">
      <p>Sistema de gesti√≥n de propietarios ¬© 2026 | Conjunto el Poblado</p>
    </div>
  </footer>

  <!-- Modal para cambiar contrase√±a -->
  <div id="modalCambiarCredenciales" class="modal" style="display: none;">
    <div class="modal-content">
      <div class="modal-header">
        <h2>üîê Cambiar Credenciales</h2>
        <button type="button" class="modal-close" id="btnCerrarModal">&times;</button>
      </div>
      
      <div class="modal-body">
        <div class="tabs">
          <button class="tab-btn active" data-tab="password">üîë Contrase√±a</button>
          <button class="tab-btn" data-tab="username">üë§ Usuario</button>
        </div>

        <!-- Pesta√±a de contrase√±a -->
        <div id="tab-password" class="tab-content active">
          <form id="formCambiarPassword">
            <div class="form-group">
              <label for="contrasenaActual">Contrase√±a Actual</label>
              <input id="contrasenaActual" type="password" placeholder="Ingresa tu contrase√±a actual" required />
            </div>

            <div class="form-group">
              <label for="contrasenaNueva">Contrase√±a Nueva</label>
              <input id="contrasenaNueva" type="password" placeholder="M√≠nimo 6 caracteres" required />
            </div>

            <div class="form-group">
              <label for="confirmacion">Confirmar Contrase√±a</label>
              <input id="confirmacion" type="password" placeholder="Confirma tu nueva contrase√±a" required />
            </div>

            <div id="msgPassword" class="msg"></div>

            <button type="submit" class="btn" style="width: 100%; margin-top: 10px;">Cambiar Contrase√±a</button>
          </form>
        </div>

        <!-- Pesta√±a de usuario -->
        <div id="tab-username" class="tab-content" style="display: none;">
          <form id="formCambiarUsername">
            <div class="form-group">
              <label for="usuarioActual">Usuario Actual</label>
              <input id="usuarioActual" type="text" disabled />
            </div>

            <div class="form-group">
              <label for="usuarioNuevo">Usuario Nuevo</label>
              <input id="usuarioNuevo" type="text" placeholder="M√≠nimo 3 caracteres" required />
            </div>

            <div id="msgUsername" class="msg"></div>

            <button type="submit" class="btn" style="width: 100%; margin-top: 10px;">Cambiar Usuario</button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>
